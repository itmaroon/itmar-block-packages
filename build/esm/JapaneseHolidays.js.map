{"version":3,"file":"JapaneseHolidays.js","sources":["../../src/JapaneseHolidays.js"],"sourcesContent":["export const JapaneseHolidays = async (apiKey, targetMonth) => {\r\n  //Google API Client Libraryをプロジェクトに追加する(非同期で読み込み)\r\n  const loadGoogleAPI = () => {\r\n    return new Promise((resolve, reject) => {\r\n      //window.gapi の存在を直接チェック\r\n      if (window.gapi) {\r\n        resolve();\r\n        return;\r\n      }\r\n\r\n      const script = document.createElement(\"script\");\r\n      script.src = \"https://apis.google.com/js/api.js\";\r\n      script.async = true;\r\n      script.defer = true;\r\n      //スクリプトがロードされたときのイベントハンドラ\r\n      script.onload = () => {\r\n        // gapiがロードされるまでチェックを繰り返す\r\n        const checkGapi = () => {\r\n          if (window.gapi) {\r\n            resolve();\r\n          } else {\r\n            setTimeout(checkGapi, 20); // Check again after 20ms\r\n          }\r\n        };\r\n        checkGapi();\r\n      };\r\n\r\n      script.onerror = () =>\r\n        reject(new Error(\"Failed to load Google API script\"));\r\n\r\n      // Check if the script is already in the document\r\n      if (\r\n        !document.querySelector(\r\n          'script[src=\"https://apis.google.com/js/api.js\"]',\r\n        )\r\n      ) {\r\n        document.body.appendChild(script);\r\n      }\r\n    });\r\n  };\r\n  //APIキーを使用してクライアントを初期化する\r\n  const initClient = async () => {\r\n    if (!window.gapi) {\r\n      throw new Error(\"Google API not loaded\");\r\n    }\r\n\r\n    // Check if gapi.client is already available\r\n    if (!window.gapi.client) {\r\n      // If not, load the client module\r\n      await new Promise((resolve) => window.gapi.load(\"client\", resolve));\r\n    }\r\n\r\n    if (window.gapi.client.calendar) {\r\n      return;\r\n    }\r\n    await window.gapi.client.init({\r\n      apiKey: apiKey,\r\n      discoveryDocs: [\r\n        \"https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest\",\r\n      ],\r\n    });\r\n  };\r\n  //祝日データの取得\r\n  const fetchHolidays = async () => {\r\n    const periodObj = getPeriodQuery(targetMonth);\r\n\r\n    const response = await window.gapi.client.calendar.events.list({\r\n      calendarId: CALENDAR_ID,\r\n      timeMin: periodObj.after,\r\n      timeMax: periodObj.before,\r\n      singleEvents: true,\r\n      orderBy: \"startTime\",\r\n    });\r\n\r\n    const events = response.result.items;\r\n    return events.map((event) => ({\r\n      date: event.start.date,\r\n      name: event.summary,\r\n    }));\r\n  };\r\n\r\n  try {\r\n    await loadGoogleAPI();\r\n    await initClient();\r\n    return await fetchHolidays();\r\n  } catch (error) {\r\n    console.error(\"エラーが発生しました:\", error);\r\n    throw error;\r\n  }\r\n};\r\n"],"names":["JapaneseHolidays","_ref","_asyncToGenerator","apiKey","targetMonth","loadGoogleAPI","Promise","resolve","reject","window","gapi","script","document","createElement","src","async","defer","onload","checkGapi","setTimeout","onerror","Error","querySelector","body","appendChild","initClient","_ref2","client","load","calendar","init","discoveryDocs","apply","arguments","fetchHolidays","_ref3","periodObj","getPeriodQuery","response","events","list","calendarId","CALENDAR_ID","timeMin","after","timeMax","before","singleEvents","orderBy","result","items","map","event","date","start","name","summary","error","console","_x","_x2"],"mappings":"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"}