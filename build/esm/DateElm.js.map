{"version":3,"file":"DateElm.js","sources":["../../src/DateElm.js"],"sourcesContent":["import { __ } from \"@wordpress/i18n\";\r\nimport { nanoid } from \"nanoid/non-secure\";\r\nimport {\r\n  PanelBody,\r\n  PanelRow,\r\n  __experimentalNumberControl as NumberControl,\r\n} from \"@wordpress/components\";\r\n\r\n//Google Calender APIから祝日データを取得するためのID\r\nconst CALENDAR_ID = \"japanese__ja@holiday.calendar.google.com\";\r\n\r\n//期間の設定から選択できる月の情報オブジェクトを配列にする関数\r\nexport const generateDateArray = (dateObj, isMonth) => {\r\n  const { startYear, startMonth, endYear, endMonth } = dateObj;\r\n  const result = [];\r\n\r\n  for (let year = startYear; year <= endYear; year++) {\r\n    if (isMonth) {\r\n      const monthStart = year === startYear ? startMonth : 1;\r\n      const monthEnd = year === endYear ? endMonth : 12;\r\n\r\n      for (let month = monthStart; month <= monthEnd; month++) {\r\n        const unitObj = {\r\n          id: nanoid(5),\r\n          value: `${year}/${month.toString().padStart(2, \"0\")}`,\r\n          label: `${year}/${month.toString().padStart(2, \"0\")}`,\r\n          classname: \"filter_date\",\r\n        };\r\n        result.push(unitObj);\r\n      }\r\n    } else {\r\n      const unitObj = {\r\n        id: nanoid(5),\r\n        value: `${year}`,\r\n        label: `${year}`,\r\n        classname: \"filter_date\",\r\n      };\r\n      result.push(unitObj);\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\n//与えられた月から日付と曜日を要素とする配列を生成する\r\nexport const generateMonthCalendar = (dateString, holidays = null) => {\r\n  const [year, month] = dateString.split(\"/\").map(Number);\r\n  const date = new Date(year, month - 1, 1);\r\n  const lastDay = new Date(year, month, 0).getDate();\r\n\r\n  const calendar = [];\r\n\r\n  for (let day = 1; day <= lastDay; day++) {\r\n    date.setDate(day);\r\n    //祝日の情報\r\n    const holidayItem = holidays?.find((item) => {\r\n      const s = String(item.date ?? \"\");\r\n\r\n      // item.date から YYYY, MM, DD を取り出す（\"YYYYMMDD\" / \"YYYY-MM-DD\" などに対応）\r\n      const yearStr = s.slice(0, 4);\r\n      const monthStr = s.replace(/\\D/g, \"\").slice(4, 6); // 数字だけにして5-6桁\r\n      const dayStr = s.replace(/\\D/g, \"\").slice(6, 8); // 数字だけにして7-8桁\r\n\r\n      const itemYear = Number(yearStr);\r\n      const itemMonth = Number(monthStr);\r\n      const itemDay = Number(dayStr);\r\n\r\n      return itemYear === year && itemMonth === month && itemDay === day;\r\n    });\r\n    //日付情報オブジェクト\r\n    const dayObj = holidayItem\r\n      ? {\r\n          date: day,\r\n          weekday: date.getDay(),\r\n          holiday: holidayItem.name,\r\n        }\r\n      : {\r\n          date: day,\r\n          weekday: date.getDay(),\r\n        };\r\n    calendar.push(dayObj);\r\n  }\r\n\r\n  return calendar;\r\n};\r\n\r\n//期間設定のインスペクターコントロール\r\nexport const PeriodCtrl = ({\r\n  startYear,\r\n  endYear,\r\n  dateSpan,\r\n  isMonth,\r\n  onChange,\r\n}) => {\r\n  return (\r\n    <PanelBody\r\n      title={__(\"Period Setting\", \"block-collections\")}\r\n      initialOpen={true}\r\n      className=\"form_setteing_ctrl\"\r\n    >\r\n      <label>{__(\"Start of period\", \"block-collections\")}</label>\r\n      <PanelRow className=\"itmar_date_span\">\r\n        <NumberControl\r\n          label={__(\"Year\", \"block-collections\")}\r\n          labelPosition=\"side\"\r\n          max={endYear}\r\n          min={startYear}\r\n          onChange={(newValue) => {\r\n            const newSpanObj = {\r\n              dateSpan: {\r\n                ...dateSpan,\r\n                startYear: Number(newValue),\r\n              },\r\n            };\r\n            onChange(newSpanObj);\r\n          }}\r\n          value={dateSpan.startYear}\r\n        />\r\n        {isMonth && (\r\n          <NumberControl\r\n            label={__(\"Month\", \"block-collections\")}\r\n            labelPosition=\"side\"\r\n            max={12}\r\n            min={1}\r\n            onChange={(newValue) => {\r\n              const newSpanObj = {\r\n                dateSpan: {\r\n                  ...dateSpan,\r\n                  startMonth: Number(newValue),\r\n                },\r\n              };\r\n              onChange(newSpanObj);\r\n            }}\r\n            value={dateSpan.startMonth}\r\n          />\r\n        )}\r\n      </PanelRow>\r\n      <label>{__(\"End of period\", \"block-collections\")}</label>\r\n      <PanelRow className=\"itmar_date_span\">\r\n        <NumberControl\r\n          label={__(\"Year\", \"block-collections\")}\r\n          labelPosition=\"side\"\r\n          max={endYear}\r\n          min={startYear}\r\n          onChange={(newValue) => {\r\n            const newSpanObj = {\r\n              dateSpan: {\r\n                ...dateSpan,\r\n                endYear: Number(newValue),\r\n              },\r\n            };\r\n            onChange(newSpanObj);\r\n          }}\r\n          value={dateSpan.endYear}\r\n        />\r\n        <NumberControl\r\n          label={__(\"Month\", \"block-collections\")}\r\n          labelPosition=\"side\"\r\n          max={12}\r\n          min={1}\r\n          onChange={(newValue) => {\r\n            const newSpanObj = {\r\n              dateSpan: {\r\n                ...dateSpan,\r\n                endMonth: Number(newValue),\r\n              },\r\n            };\r\n            onChange(newSpanObj);\r\n          }}\r\n          value={dateSpan.endMonth}\r\n        />\r\n      </PanelRow>\r\n    </PanelBody>\r\n  );\r\n};\r\n\r\n//日付から期間のクエリー用の配列を生成\r\nexport const getPeriodQuery = (dateString) => {\r\n  if (!dateString) {\r\n    return null; //与えられた文字列が空ならnullをかえす\r\n  }\r\n  const parts = dateString.split(\"/\");\r\n  const year = parseInt(parts[0], 10);\r\n  const month = parts.length > 1 ? parseInt(parts[1], 10) : null;\r\n  const day = parts.length > 2 ? parseInt(parts[2], 10) : null;\r\n\r\n  let startDate, endDate;\r\n\r\n  if (day) {\r\n    // 特定の日\r\n    startDate = new Date(year, month - 1, day, 0, 0, 0, -1);\r\n    endDate = new Date(year, month - 1, day, 23, 59, 59, 1000);\r\n  } else if (month) {\r\n    // 特定の月\r\n    startDate = new Date(year, month - 1, 1, 0, 0, 0, -1);\r\n    endDate = new Date(year, month, 1, 0, 0, 0, 0);\r\n  } else {\r\n    // 特定の年\r\n    startDate = new Date(year, 0, 1, 0, 0, 0, -1);\r\n    endDate = new Date(year + 1, 0, 1, 0, 0, 0, 0);\r\n  }\r\n\r\n  return {\r\n    after: startDate.toISOString(),\r\n    before: endDate.toISOString(),\r\n  };\r\n};\r\n\r\n//本日の日付から'YYYY/MM'形式の日付文字列を生成する\r\nexport const getTodayYearMonth = () => {\r\n  const today = new Date();\r\n  const year = today.getFullYear();\r\n  const month = String(today.getMonth() + 1).padStart(2, \"0\");\r\n  return `${year}/${month}`;\r\n};\r\n//本日の日付から年を返す\r\nexport const getTodayYear = () => {\r\n  const today = new Date();\r\n  return today.getFullYear();\r\n};\r\n//本日の日付から月を返す\r\nexport const getTodayMonth = () => {\r\n  const today = new Date();\r\n  return today.getMonth() + 1;\r\n};\r\n\r\n// \"2026/01\" -> { ym:\"2026-01\", from:\"2026-01-01\", to:\"2026-01-31\", year:2026, month:1 }\r\nconst pad2 = (n) => String(n).padStart(2, \"0\");\r\nexport const getMonthRangeYmd = (selectedMonth) => {\r\n  if (!selectedMonth)\r\n    return { ym: \"\", from: \"\", to: \"\", year: 0, month: 0, lastDay: 0 };\r\n  const [yStr, mStr] = String(selectedMonth).split(\"/\");\r\n  const year = Number(yStr);\r\n  const month = Number(mStr);\r\n  if (!year || !month)\r\n    return { ym: \"\", from: \"\", to: \"\", year: 0, month: 0, lastDay: 0 };\r\n\r\n  const lastDay = new Date(year, month, 0).getDate();\r\n  const mm = pad2(month);\r\n  return {\r\n    ym: `${year}-${mm}`,\r\n    from: `${year}-${mm}-01`,\r\n    to: `${year}-${mm}-${pad2(lastDay)}`,\r\n    year,\r\n    month,\r\n    lastDay,\r\n  };\r\n};\r\n\r\nexport const normalizeDateYYYYMMDD = (value) => {\r\n  // 期待値: 'YYYY-MM-DD'\r\n  if (!value) return \"\";\r\n  return String(value).slice(0, 10);\r\n};\r\n\r\nexport const toYmdFromMonthAndDay = (selectedMonth, dayValue) => {\r\n  if (!dayValue) return \"\";\r\n\r\n  const dayStr = String(dayValue).trim();\r\n\r\n  // already \"YYYY-MM-DD\"\r\n  if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dayStr)) return dayStr;\r\n\r\n  // 8 digits \"YYYYMMDD\"\r\n  if (/^\\d{8}$/.test(dayStr)) {\r\n    const y = dayStr.slice(0, 4);\r\n    const m = dayStr.slice(4, 6);\r\n    const d = dayStr.slice(6, 8);\r\n    return `${y}-${m}-${d}`;\r\n  }\r\n  // day-of-month number\r\n  const dayNum = Number(dayStr);\r\n  if (!selectedMonth || !dayNum) return \"\";\r\n  const [yStr, mStr] = String(selectedMonth).split(\"/\");\r\n  if (!yStr || !mStr) return \"\";\r\n  return `${yStr}-${pad2(Number(mStr))}-${pad2(dayNum)}`;\r\n};\r\n\r\n/* ------------------------------\r\nカレンダー用グリッドAreasの生成関数\r\n------------------------------ */\r\nconst week = [\"sun\", \"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\"];\r\nexport const generateGridAreas = (firstDayOfMonth, totalDays, isMonday) => {\r\n  let areas = [];\r\n  let currentDay = 1;\r\n  //月曜日を先頭に持ってくる場合の係数\r\n  const mondayFirstDay = firstDayOfMonth - 1 < 0 ? 6 : firstDayOfMonth - 1;\r\n  //先頭曜日の選択\r\n  const modifyFirstDay = isMonday ? mondayFirstDay : firstDayOfMonth;\r\n\r\n  //曜日ラベル\r\n  let weekLabels = [];\r\n  let week_index;\r\n  for (let i = 0; i < 7; i++) {\r\n    week_index = isMonday ? i + 1 : i; //月曜日を先頭に持ってくる場合の補正\r\n    if (week_index > 6) week_index = 0;\r\n    weekLabels.push(week[week_index]);\r\n  }\r\n  areas.push(weekLabels.join(\" \"));\r\n\r\n  for (let i = 0; i < 6; i++) {\r\n    // 6週分のループ\r\n    let week = [];\r\n    for (let j = 0; j < 7; j++) {\r\n      // 1週間の7日分のループ\r\n      if ((i === 0 && j < modifyFirstDay) || currentDay > totalDays) {\r\n        week.push(`empty${i}`);\r\n      } else {\r\n        week.push(`day${currentDay}`);\r\n        currentDay++;\r\n      }\r\n    }\r\n    if (i == 5) {\r\n      //最後の週\r\n      week[5] = \"day_clear\";\r\n      week[6] = \"day_clear\";\r\n    }\r\n    areas.push(week.join(\" \"));\r\n  }\r\n  return areas.map((week) => `\"${week}\"`).join(\"\\n\");\r\n};\r\n"],"names":["generateDateArray","dateObj","isMonth","startYear","startMonth","endYear","endMonth","result","year","monthStart","monthEnd","month","unitObj","id","nanoid","value","concat","toString","padStart","label","classname","push","generateMonthCalendar","dateString","holidays","arguments","length","undefined","split","map","Number","date","Date","lastDay","getDate","calendar","_loop","day","setDate","holidayItem","find","item","_item$date","s","String","yearStr","slice","monthStr","replace","dayStr","itemYear","itemMonth","itemDay","dayObj","weekday","getDay","holiday","name","PeriodCtrl","_ref","dateSpan","onChange","React","createElement","PanelBody","title","__","initialOpen","className","PanelRow","NumberControl","labelPosition","max","min","newValue","newSpanObj","_objectSpread","getPeriodQuery","parts","parseInt","startDate","endDate","after","toISOString","before","getTodayYearMonth","today","getFullYear","getMonth","getTodayYear","getTodayMonth","pad2","n","getMonthRangeYmd","selectedMonth","ym","from","to","yStr","mStr","mm","normalizeDateYYYYMMDD","toYmdFromMonthAndDay","dayValue","trim","test","y","m","d","dayNum","week","generateGridAreas","firstDayOfMonth","totalDays","isMonday","areas","currentDay","mondayFirstDay","modifyFirstDay","weekLabels","week_index","i","join","j"],"mappings":"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"}