{"version":3,"file":"GridControls.js","sources":["../../src/GridControls.js"],"sourcesContent":["import {\r\n  Button,\r\n  Icon,\r\n  PanelRow,\r\n  ComboboxControl,\r\n  ToolbarDropdownMenu,\r\n  __experimentalNumberControl as NumberControl,\r\n  __experimentalUnitControl as UnitControl,\r\n  __experimentalInputControl as InputControl,\r\n} from \"@wordpress/components\";\r\n\r\nimport { useSelect, dispatch } from \"@wordpress/data\";\r\nimport { useState, useEffect, useRef } from \"@wordpress/element\";\r\n\r\nimport { __ } from \"@wordpress/i18n\";\r\nimport { justifyCenter, justifyLeft, justifyRight } from \"@wordpress/icons\";\r\n//上よせアイコン\r\nconst upper = <Icon icon={justifyLeft} className=\"rotate-icon\" />;\r\n//中央よせのアイコン\r\nconst middle = <Icon icon={justifyCenter} className=\"rotate-icon\" />;\r\n//下よせのアイコン\r\nconst lower = <Icon icon={justifyRight} className=\"rotate-icon\" />;\r\n// アイコンと文字列キーのマッピングを作成\r\nconst alignIconMap = {\r\n  left: justifyLeft,\r\n  center: justifyCenter,\r\n  right: justifyRight,\r\n  upper: upper,\r\n  middle: middle,\r\n  lower: lower,\r\n};\r\n\r\nconst units = [\r\n  { value: \"px\", label: \"px\" },\r\n  { value: \"em\", label: \"em\" },\r\n  { value: \"rem\", label: \"rem\" },\r\n];\r\n\r\nconst initializeUnitArray = (rowUnit, length) => {\r\n  if (!Array.isArray(rowUnit)) {\r\n    // rowUnit が配列ではない（undefined を含む）場合、全て \"1fr\" で埋めた配列を返す\r\n    return Array(length).fill(\"1fr\");\r\n  }\r\n\r\n  return Array.from({ length }, (_, i) => rowUnit[i] || \"1fr\");\r\n};\r\n\r\n//r,cで与えられた座標がgridElmsのどの要素に含まれているかを返す\r\nconst findElementInGrid = (gridElms, r, c) => {\r\n  for (let i = 0; i < gridElms.length; i++) {\r\n    const { startCell, endCell } = gridElms[i];\r\n    // 各座標の最小値と最大値を決定\r\n    const minRow = Math.min(startCell?.rowInx, endCell?.rowInx);\r\n    const maxRow = Math.max(startCell?.rowInx, endCell?.rowInx);\r\n    const minCol = Math.min(startCell?.colInx, endCell?.colInx);\r\n    const maxCol = Math.max(startCell?.colInx, endCell?.colInx);\r\n\r\n    // 座標が範囲内にあるかどうかをチェック\r\n    if (r >= minRow && r <= maxRow && c >= minCol && c <= maxCol) {\r\n      return { index: i, elm: gridElms[i] };\r\n    }\r\n  }\r\n  return null;\r\n};\r\n\r\n//親にイベントを伝播させないラッパー\r\nconst StopPropagationWrapper = ({ children }) => {\r\n  const handleClick = (event) => {\r\n    // イベントの伝播を阻止\r\n    event.stopPropagation();\r\n  };\r\n\r\n  return (\r\n    <div className=\"itmar_event_stopper\" onClick={handleClick}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst GridControls = ({ attributes, clientId, onChange }) => {\r\n  const { gridElms, rowNum, colNum, rowGap, colGap, rowUnit, colUnit } =\r\n    attributes;\r\n\r\n  //コンポーネント内の行列情報\r\n  const [rowCount, setRowCount] = useState(rowNum);\r\n  const [colCount, setColCount] = useState(colNum);\r\n\r\n  //マウント時検出用フラグ\r\n  const firstFlgRef = useRef(true);\r\n\r\n  //グリッドの配置指定用テーブル要素\r\n  const renderRows = () => {\r\n    //セルが埋まっているかどうかの判定配列\r\n\r\n    const occupied = new Array(rowCount)\r\n      .fill(0)\r\n      .map(() => new Array(colCount).fill(false));\r\n\r\n    let rows = [];\r\n    // 列単位入力行を追加\r\n    let headerCells = [<th key=\"header-corner\"></th>]; // 左上の角の空白セル\r\n    for (let c = 0; c < colCount; c++) {\r\n      headerCells.push(\r\n        <th key={`header-${c}`}>\r\n          <InputControl\r\n            value={colUnit ? colUnit[c] : \"\"}\r\n            type=\"text\"\r\n            isPressEnterToChange={true}\r\n            onChange={(newValue) => {\r\n              const newArray = [\r\n                ...colUnit.slice(0, c),\r\n                newValue,\r\n                ...colUnit.slice(c + 1),\r\n              ];\r\n              setUnitColArray(newArray);\r\n            }}\r\n          />\r\n        </th>\r\n      );\r\n    }\r\n    rows.push(<tr key=\"header-row\">{headerCells}</tr>);\r\n\r\n    // 各行とセルの生成\r\n    for (let r = 0; r < rowCount; r++) {\r\n      let cells = [];\r\n      // 行行単位入力を追加\r\n      cells.push(\r\n        <th key={`row-header-${r}`}>\r\n          <InputControl\r\n            value={rowUnit ? rowUnit[r] : \"\"}\r\n            type=\"text\"\r\n            isPressEnterToChange={true}\r\n            onChange={(newValue) => {\r\n              const newArray = [\r\n                ...rowUnit.slice(0, r),\r\n                newValue,\r\n                ...rowUnit.slice(r + 1),\r\n              ];\r\n              setUnitRowArray(newArray);\r\n            }}\r\n          />\r\n        </th>\r\n      );\r\n\r\n      // 各行に対するセルを生成\r\n      for (let c = 0; c < colCount; c++) {\r\n        if (occupied[r][c]) {\r\n          continue; // このセルは既に占められているのでスキップ\r\n        }\r\n        //複数のセルを占める設定があればセルの結合オブジェクトを生成\r\n        const setElm = findElementInGrid(gridElms, r, c);\r\n        const rowSpanValue = setElm\r\n          ? Math.abs(setElm.elm.startCell.rowInx - setElm.elm.endCell.rowInx)\r\n          : 0;\r\n        const colSpanValue = setElm\r\n          ? Math.abs(setElm.elm.startCell.colInx - setElm.elm.endCell.colInx)\r\n          : 0;\r\n        const cellSpan = {\r\n          ...(rowSpanValue !== 0 && { rowspan: rowSpanValue + 1 }),\r\n          ...(colSpanValue !== 0 && { colspan: colSpanValue + 1 }),\r\n        };\r\n        // 占められるセルの位置を記録\r\n        for (let i = 0; i <= rowSpanValue; i++) {\r\n          for (let j = 0; j <= colSpanValue; j++) {\r\n            if (r + i < rowCount && c + j < colCount) {\r\n              occupied[r + i][c + j] = true;\r\n            }\r\n          }\r\n        }\r\n        //セルを生成\r\n        cells.push(\r\n          <td\r\n            key={`cell-${r}-${c}`}\r\n            {...cellSpan}\r\n            className={isCellSelected(r, c) ? \"selected\" : \"\"}\r\n            style={\r\n              setElm\r\n                ? {\r\n                    backgroundColor: `var(--wp--custom--color--area-${setElm.index})`,\r\n                  }\r\n                : undefined\r\n            }\r\n            onClick={() => detectCellPosition(r, c)}\r\n          >\r\n            {setElm && (\r\n              <StopPropagationWrapper>\r\n                <ToolbarDropdownMenu\r\n                  label={__(\"Lateral Alignment\", \"block-collections\")}\r\n                  icon={\r\n                    setElm.elm.latAlign\r\n                      ? alignIconMap[setElm.elm.latAlign]\r\n                      : alignIconMap[\"left\"]\r\n                  }\r\n                  controls={[\"left\", \"center\", \"right\"].map((align) => ({\r\n                    icon: alignIconMap[align],\r\n                    isActive: setElm.elm.latAlign === align,\r\n                    onClick: () =>\r\n                      updateAlignment(setElm.index, align, \"latAlign\"),\r\n                  }))}\r\n                />\r\n                <ToolbarDropdownMenu\r\n                  label={__(\"Vertical Alignment\", \"block-collections\")}\r\n                  icon={\r\n                    setElm.elm.vertAlign\r\n                      ? alignIconMap[setElm.elm.vertAlign]\r\n                      : alignIconMap[\"upper\"]\r\n                  }\r\n                  controls={[\"upper\", \"middle\", \"lower\"].map((align) => ({\r\n                    icon: alignIconMap[align],\r\n                    isActive: setElm.elm.vertAlign === align,\r\n                    onClick: () =>\r\n                      updateAlignment(setElm.index, align, \"vertAlign\"),\r\n                  }))}\r\n                />\r\n              </StopPropagationWrapper>\r\n            )}\r\n          </td>\r\n        );\r\n      }\r\n      // 行の追加\r\n      rows.push(<tr key={`row-${r}`}>{cells}</tr>);\r\n    }\r\n    return rows;\r\n  };\r\n\r\n  //テーブルの位置選択関数\r\n  const detectCellPosition = (rowIndex, colIndex) => {\r\n    //インナーブロックの選択がなければリターン\r\n    if (!selBlock) {\r\n      dispatch(\"core/notices\").createNotice(\r\n        \"error\",\r\n        __(\"No blocks selected.\", \"itmar_guest_contact_block\"),\r\n        { type: \"snackbar\", isDismissible: true }\r\n      );\r\n      return;\r\n    }\r\n    //選択済みのセルが選択されたときはリターン\r\n    if (findElementInGrid(gridElms, rowIndex, colIndex)) {\r\n      dispatch(\"core/notices\").createNotice(\r\n        \"error\",\r\n        __(\r\n          \"That cell is already selected by another block.\",\r\n          \"itmar_guest_contact_block\"\r\n        ),\r\n        { type: \"snackbar\", isDismissible: true }\r\n      );\r\n      return;\r\n    }\r\n\r\n    //選択されたブロックのポジションを記録\r\n    const newBlock = !selBlock.startCell\r\n      ? {\r\n          ...selBlock,\r\n          startCell: { rowInx: rowIndex, colInx: colIndex },\r\n          endCell: { rowInx: rowIndex, colInx: colIndex },\r\n        }\r\n      : { ...selBlock, endCell: { rowInx: rowIndex, colInx: colIndex } };\r\n\r\n    setSelBlock(newBlock);\r\n\r\n    //blockNamesの更新\r\n    const index = gridElms?.findIndex(\r\n      (block) => block.value === selBlock.value\r\n    );\r\n    const setAreaBlock = [\r\n      ...blockNames.slice(0, index),\r\n      newBlock,\r\n      ...blockNames.slice(index + 1),\r\n    ];\r\n    setBlockNames(setAreaBlock);\r\n  };\r\n\r\n  // セルが選択されているか判断する関数\r\n  const isCellSelected = (rowIndex, colIndex) => {\r\n    if (selBlock) {\r\n      // 各座標の最小値と最大値を決定\r\n      const minRow = Math.min(\r\n        selBlock.startCell?.rowInx,\r\n        selBlock.endCell?.rowInx\r\n      );\r\n      const maxRow = Math.max(\r\n        selBlock.startCell?.rowInx,\r\n        selBlock.endCell?.rowInx\r\n      );\r\n      const minCol = Math.min(\r\n        selBlock.startCell?.colInx,\r\n        selBlock.endCell?.colInx\r\n      );\r\n      const maxCol = Math.max(\r\n        selBlock.startCell?.colInx,\r\n        selBlock.endCell?.colInx\r\n      );\r\n\r\n      // 座標が範囲内にあるかどうかをチェック\r\n      return (\r\n        rowIndex >= minRow &&\r\n        rowIndex <= maxRow &&\r\n        colIndex >= minCol &&\r\n        colIndex <= maxCol\r\n      );\r\n    } else {\r\n      return false;\r\n    }\r\n  };\r\n\r\n  //コンテンツ位置設定\r\n  const updateAlignment = (index, align, derection) => {\r\n    const alignBlock = { ...blockNames[index], [derection]: align };\r\n    const setAlignBlock = [\r\n      ...blockNames.slice(0, index),\r\n      alignBlock,\r\n      ...blockNames.slice(index + 1),\r\n    ];\r\n    setBlockNames(setAlignBlock);\r\n  };\r\n\r\n  //選択したインナーブロック\r\n  const [selBlock, setSelBlock] = useState(null);\r\n\r\n  //インナーブロックを取得\r\n  const parentBlocks = useSelect(\r\n    (select) => {\r\n      const innerBlocks = select(\"core/block-editor\").getBlocks(clientId);\r\n      //インナーブロック入れ替えの際は既に登録したブロックの位置情報があれば、それを付加する。\r\n      const new_block_names = innerBlocks.map((block, index) =>\r\n        gridElms.length > index\r\n          ? {\r\n              value: block.clientId,\r\n              label: block.name,\r\n              startCell: gridElms[index].startCell,\r\n              endCell: gridElms[index].endCell,\r\n              latAlign: gridElms[index].latAlign,\r\n              vertAlign: gridElms[index].vertAlign,\r\n            }\r\n          : {\r\n              value: block.clientId,\r\n              label: block.name,\r\n            }\r\n      );\r\n      return new_block_names;\r\n    },\r\n    [clientId]\r\n  );\r\n  const [blockNames, setBlockNames] = useState(parentBlocks);\r\n\r\n  //グリッド配置のクリア\r\n  const clear_placement = () => {\r\n    //ブロックの配置情報削除\r\n    const clear_block = blockNames.map((block) => ({\r\n      value: block.value,\r\n      label: block.label,\r\n    }));\r\n    setBlockNames(clear_block);\r\n  };\r\n\r\n  //単位配列の初期化\r\n  const initRowUnitArray = initializeUnitArray(rowUnit, rowCount);\r\n  const [unitRowArray, setUnitRowArray] = useState(initRowUnitArray);\r\n  const initColUnitArray = initializeUnitArray(colUnit, colCount);\r\n  const [unitColArray, setUnitColArray] = useState(initColUnitArray);\r\n\r\n  //親ブロックへの書き戻し\r\n  useEffect(() => {\r\n    const gridStyle = {\r\n      ...attributes,\r\n      gridElms: blockNames,\r\n      rowNum: rowCount,\r\n      colNum: colCount,\r\n      rowUnit: unitRowArray,\r\n      colUnit: unitColArray,\r\n    };\r\n\r\n    onChange(gridStyle);\r\n  }, [blockNames, unitRowArray, unitColArray]);\r\n\r\n  //行と列の数を変えた場合は位置情報を削除・単位の再編成\r\n  useEffect(() => {\r\n    if (!firstFlgRef.current) {\r\n      //マウント時は実行しない\r\n      //ブロックの位置情報クリア\r\n      clear_placement();\r\n      //単位情報の再編成\r\n      const newRowUnitArray = initializeUnitArray(rowUnit, rowCount);\r\n      setUnitRowArray(newRowUnitArray);\r\n      const newColUnitArray = initializeUnitArray(colUnit, colCount);\r\n      setUnitColArray(newColUnitArray);\r\n    } else {\r\n      firstFlgRef.current = false;\r\n    }\r\n  }, [rowCount, colCount]);\r\n\r\n  return (\r\n    <>\r\n      <PanelRow className=\"distance_row\">\r\n        <NumberControl\r\n          onChange={(newValue) => {\r\n            const input_val =\r\n              typeof newValue === \"number\" ? newValue : Number(newValue);\r\n            setRowCount(input_val);\r\n          }}\r\n          label={__(\"Number of Row \", \"block-collections\")}\r\n          value={rowCount}\r\n          min={2}\r\n        />\r\n        <NumberControl\r\n          onChange={(newValue) => {\r\n            const input_val =\r\n              typeof newValue === \"number\" ? newValue : Number(newValue);\r\n            setColCount(input_val);\r\n          }}\r\n          label={__(\"Number of Colum\", \"block-collections\")}\r\n          value={colCount}\r\n        />\r\n      </PanelRow>\r\n      <PanelRow className=\"distance_row\">\r\n        <UnitControl\r\n          onChange={(newValue) => {\r\n            newValue = newValue != \"\" ? newValue : \"0px\";\r\n            const newStyle = { ...attributes, rowGap: newValue };\r\n            onChange(newStyle);\r\n          }}\r\n          label={__(\"Row Gap\", \"block-collections\")}\r\n          value={rowGap}\r\n          units={units}\r\n        />\r\n        <UnitControl\r\n          onChange={(newValue) => {\r\n            newValue = newValue != \"\" ? newValue : \"0px\";\r\n            const newStyle = { ...attributes, colGap: newValue };\r\n            onChange(newStyle);\r\n          }}\r\n          label={__(\"Colum Gap\", \"block-collections\")}\r\n          value={colGap}\r\n          units={units}\r\n        />\r\n      </PanelRow>\r\n\r\n      <PanelRow className=\"distance_row\">\r\n        <p>{__(\"Element placement\", \"block-collections\")}</p>\r\n        <Button variant=\"secondary\" onClick={clear_placement}>\r\n          {__(\"Clear\", \"block-collections\")}\r\n        </Button>\r\n      </PanelRow>\r\n\r\n      <PanelRow className=\"grid_table\">\r\n        <table>{renderRows()}</table>\r\n      </PanelRow>\r\n      <ComboboxControl\r\n        label={__(\"InnerBlock Name\", \"block-collections\")}\r\n        options={blockNames}\r\n        value={selBlock ? selBlock.value : null}\r\n        onChange={(sel_id) => {\r\n          const matchedBlock = blockNames.find(\r\n            (block) => block.value === sel_id\r\n          );\r\n          setSelBlock(matchedBlock);\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n};\r\nexport default GridControls;\r\n"],"names":["upper","React","createElement","Icon","icon","justifyLeft","className","middle","justifyCenter","lower","justifyRight","alignIconMap","left","center","right","units","value","label","initializeUnitArray","rowUnit","length","Array","isArray","fill","from","_","i","findElementInGrid","gridElms","r","c","startCell","endCell","minRow","Math","min","rowInx","maxRow","max","minCol","colInx","maxCol","index","elm","StopPropagationWrapper","_ref","children","handleClick","event","stopPropagation","onClick","GridControls","_ref2","attributes","clientId","onChange","rowNum","colNum","rowGap","colGap","colUnit","rowCount","setRowCount","useState","colCount","setColCount","firstFlgRef","useRef","renderRows","occupied","map","rows","headerCells","key","_loop","push","concat","InputControl","type","isPressEnterToChange","newValue","newArray","slice","setUnitColArray","_loop2","cells","setUnitRowArray","_loop3","_c","setElm","rowSpanValue","abs","colSpanValue","cellSpan","_objectSpread","rowspan","colspan","j","_extends","isCellSelected","style","backgroundColor","undefined","detectCellPosition","ToolbarDropdownMenu","__","latAlign","controls","align","isActive","updateAlignment","vertAlign","rowIndex","colIndex","selBlock","dispatch","createNotice","isDismissible","newBlock","setSelBlock","findIndex","block","setAreaBlock","blockNames","setBlockNames","_selBlock$startCell","_selBlock$endCell","_selBlock$startCell2","_selBlock$endCell2","_selBlock$startCell3","_selBlock$endCell3","_selBlock$startCell4","_selBlock$endCell4","derection","alignBlock","setAlignBlock","parentBlocks","useSelect","select","innerBlocks","getBlocks","new_block_names","name","clear_placement","clear_block","initRowUnitArray","unitRowArray","initColUnitArray","unitColArray","useEffect","gridStyle","current","newRowUnitArray","newColUnitArray","Fragment","PanelRow","NumberControl","input_val","Number","UnitControl","newStyle","Button","variant","ComboboxControl","options","sel_id","matchedBlock","find"],"mappings":"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"}